"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_src_lib_streak-manager_ts";
exports.ids = ["_rsc_src_lib_streak-manager_ts"];
exports.modules = {

/***/ "(rsc)/./src/lib/streak-manager.ts":
/*!***********************************!*\
  !*** ./src/lib/streak-manager.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkAndResetInactiveStreaks: () => (/* binding */ checkAndResetInactiveStreaks),\n/* harmony export */   getUserStreak: () => (/* binding */ getUserStreak),\n/* harmony export */   updateUserStreak: () => (/* binding */ updateUserStreak)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/**\n * Streak Management Utility\n * Handles user streak tracking and updates\n */ \n/**\n * Check if two dates are on consecutive days\n */ function isConsecutiveDay(lastDate, currentDate) {\n    const lastDay = new Date(lastDate);\n    lastDay.setHours(0, 0, 0, 0);\n    const currentDay = new Date(currentDate);\n    currentDay.setHours(0, 0, 0, 0);\n    const diffTime = currentDay.getTime() - lastDay.getTime();\n    const diffDays = diffTime / (1000 * 60 * 60 * 24);\n    return diffDays === 1;\n}\n/**\n * Check if two dates are on the same day\n */ function isSameDay(date1, date2) {\n    const day1 = new Date(date1);\n    day1.setHours(0, 0, 0, 0);\n    const day2 = new Date(date2);\n    day2.setHours(0, 0, 0, 0);\n    return day1.getTime() === day2.getTime();\n}\n/**\n * Check if more than 24 hours have passed since last post\n */ function isStreakBroken(lastDate, currentDate) {\n    const lastDay = new Date(lastDate);\n    lastDay.setHours(0, 0, 0, 0);\n    const currentDay = new Date(currentDate);\n    currentDay.setHours(0, 0, 0, 0);\n    const diffTime = currentDay.getTime() - lastDay.getTime();\n    const diffDays = diffTime / (1000 * 60 * 60 * 24);\n    return diffDays > 1;\n}\n/**\n * Update user streak when they post\n */ async function updateUserStreak(userId) {\n    const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n        where: {\n            id: userId\n        },\n        select: {\n            streakDays: true,\n            lastStreakDate: true,\n            longestStreak: true\n        }\n    });\n    if (!user) {\n        throw new Error(\"User not found\");\n    }\n    const now = new Date();\n    let newStreakDays = user.streakDays;\n    let newLongestStreak = user.longestStreak;\n    let streakIncreased = false;\n    let streakReset = false;\n    if (!user.lastStreakDate) {\n        // First time posting - start streak at 1\n        newStreakDays = 1;\n        streakIncreased = true;\n    } else if (isSameDay(user.lastStreakDate, now)) {\n        // Already posted today - no change to streak\n        newStreakDays = user.streakDays;\n    } else if (isConsecutiveDay(user.lastStreakDate, now)) {\n        // Posted on consecutive day - increment streak\n        newStreakDays = user.streakDays + 1;\n        streakIncreased = true;\n    } else if (isStreakBroken(user.lastStreakDate, now)) {\n        // Streak broken - reset to 1\n        newStreakDays = 1;\n        streakReset = true;\n    }\n    // Update longest streak if current is higher\n    if (newStreakDays > newLongestStreak) {\n        newLongestStreak = newStreakDays;\n    }\n    // Update user in database\n    await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.update({\n        where: {\n            id: userId\n        },\n        data: {\n            streakDays: newStreakDays,\n            lastStreakDate: now,\n            longestStreak: newLongestStreak,\n            lastActiveAt: now\n        }\n    });\n    return {\n        streakDays: newStreakDays,\n        longestStreak: newLongestStreak,\n        streakIncreased,\n        streakReset\n    };\n}\n/**\n * Get user's current streak status\n */ async function getUserStreak(userId) {\n    const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findUnique({\n        where: {\n            id: userId\n        },\n        select: {\n            streakDays: true,\n            lastStreakDate: true,\n            longestStreak: true\n        }\n    });\n    if (!user) {\n        throw new Error(\"User not found\");\n    }\n    const now = new Date();\n    let isActive = false;\n    let currentStreak = user.streakDays;\n    // Check if streak is still active\n    if (user.lastStreakDate) {\n        if (isSameDay(user.lastStreakDate, now)) {\n            // Posted today - streak is active\n            isActive = true;\n        } else if (isConsecutiveDay(user.lastStreakDate, now)) {\n            // Last post was yesterday - streak is at risk but still active\n            isActive = true;\n        } else if (isStreakBroken(user.lastStreakDate, now)) {\n            // Streak is broken - should be reset on next post\n            currentStreak = 0;\n            isActive = false;\n        }\n    }\n    return {\n        currentStreak,\n        longestStreak: user.longestStreak,\n        lastPostDate: user.lastStreakDate,\n        isActive\n    };\n}\n/**\n * Check and reset streaks for users who haven't posted in >24h\n * This should be run as a scheduled job\n */ async function checkAndResetInactiveStreaks() {\n    const now = new Date();\n    const yesterday = new Date(now);\n    yesterday.setDate(yesterday.getDate() - 1);\n    yesterday.setHours(0, 0, 0, 0);\n    // Find users whose last post was more than 1 day ago and have an active streak\n    const inactiveUsers = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.findMany({\n        where: {\n            streakDays: {\n                gt: 0\n            },\n            lastStreakDate: {\n                lt: yesterday\n            }\n        },\n        select: {\n            id: true\n        }\n    });\n    // Reset their streaks\n    if (inactiveUsers.length > 0) {\n        await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.user.updateMany({\n            where: {\n                id: {\n                    in: inactiveUsers.map((u)=>u.id)\n                }\n            },\n            data: {\n                streakDays: 0\n            }\n        });\n    }\n    return inactiveUsers.length;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUc7SUFFNUIsK0VBQStFO0lBQy9FLE1BQU1zQyxnQkFBZ0IsTUFBTTVDLCtDQUFNQSxDQUFDbUIsSUFBSSxDQUFDMEIsUUFBUSxDQUFDO1FBQy9DeEIsT0FBTztZQUNMRyxZQUFZO2dCQUFFc0IsSUFBSTtZQUFFO1lBQ3BCckIsZ0JBQWdCO2dCQUFFc0IsSUFBSU47WUFBVTtRQUNsQztRQUNBbEIsUUFBUTtZQUFFRCxJQUFJO1FBQUs7SUFDckI7SUFFQSxzQkFBc0I7SUFDdEIsSUFBSXNCLGNBQWNJLE1BQU0sR0FBRyxHQUFHO1FBQzVCLE1BQU1oRCwrQ0FBTUEsQ0FBQ21CLElBQUksQ0FBQzhCLFVBQVUsQ0FBQztZQUMzQjVCLE9BQU87Z0JBQ0xDLElBQUk7b0JBQUU0QixJQUFJTixjQUFjTyxHQUFHLENBQUNDLENBQUFBLElBQUtBLEVBQUU5QixFQUFFO2dCQUFFO1lBQ3pDO1lBQ0FZLE1BQU07Z0JBQ0pWLFlBQVk7WUFDZDtRQUNGO0lBQ0Y7SUFFQSxPQUFPb0IsY0FBY0ksTUFBTTtBQUM3QiIsInNvdXJjZXMiOlsid2VicGFjazovL3gtd29ybGQtbWluaS1hcHAvLi9zcmMvbGliL3N0cmVhay1tYW5hZ2VyLnRzP2M4MDYiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBTdHJlYWsgTWFuYWdlbWVudCBVdGlsaXR5XG4gKiBIYW5kbGVzIHVzZXIgc3RyZWFrIHRyYWNraW5nIGFuZCB1cGRhdGVzXG4gKi9cblxuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnQC9saWIvcHJpc21hJztcblxuLyoqXG4gKiBDaGVjayBpZiB0d28gZGF0ZXMgYXJlIG9uIGNvbnNlY3V0aXZlIGRheXNcbiAqL1xuZnVuY3Rpb24gaXNDb25zZWN1dGl2ZURheShsYXN0RGF0ZTogRGF0ZSwgY3VycmVudERhdGU6IERhdGUpOiBib29sZWFuIHtcbiAgY29uc3QgbGFzdERheSA9IG5ldyBEYXRlKGxhc3REYXRlKTtcbiAgbGFzdERheS5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgXG4gIGNvbnN0IGN1cnJlbnREYXkgPSBuZXcgRGF0ZShjdXJyZW50RGF0ZSk7XG4gIGN1cnJlbnREYXkuc2V0SG91cnMoMCwgMCwgMCwgMCk7XG4gIFxuICBjb25zdCBkaWZmVGltZSA9IGN1cnJlbnREYXkuZ2V0VGltZSgpIC0gbGFzdERheS5nZXRUaW1lKCk7XG4gIGNvbnN0IGRpZmZEYXlzID0gZGlmZlRpbWUgLyAoMTAwMCAqIDYwICogNjAgKiAyNCk7XG4gIFxuICByZXR1cm4gZGlmZkRheXMgPT09IDE7XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgdHdvIGRhdGVzIGFyZSBvbiB0aGUgc2FtZSBkYXlcbiAqL1xuZnVuY3Rpb24gaXNTYW1lRGF5KGRhdGUxOiBEYXRlLCBkYXRlMjogRGF0ZSk6IGJvb2xlYW4ge1xuICBjb25zdCBkYXkxID0gbmV3IERhdGUoZGF0ZTEpO1xuICBkYXkxLnNldEhvdXJzKDAsIDAsIDAsIDApO1xuICBcbiAgY29uc3QgZGF5MiA9IG5ldyBEYXRlKGRhdGUyKTtcbiAgZGF5Mi5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgXG4gIHJldHVybiBkYXkxLmdldFRpbWUoKSA9PT0gZGF5Mi5nZXRUaW1lKCk7XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgbW9yZSB0aGFuIDI0IGhvdXJzIGhhdmUgcGFzc2VkIHNpbmNlIGxhc3QgcG9zdFxuICovXG5mdW5jdGlvbiBpc1N0cmVha0Jyb2tlbihsYXN0RGF0ZTogRGF0ZSwgY3VycmVudERhdGU6IERhdGUpOiBib29sZWFuIHtcbiAgY29uc3QgbGFzdERheSA9IG5ldyBEYXRlKGxhc3REYXRlKTtcbiAgbGFzdERheS5zZXRIb3VycygwLCAwLCAwLCAwKTtcbiAgXG4gIGNvbnN0IGN1cnJlbnREYXkgPSBuZXcgRGF0ZShjdXJyZW50RGF0ZSk7XG4gIGN1cnJlbnREYXkuc2V0SG91cnMoMCwgMCwgMCwgMCk7XG4gIFxuICBjb25zdCBkaWZmVGltZSA9IGN1cnJlbnREYXkuZ2V0VGltZSgpIC0gbGFzdERheS5nZXRUaW1lKCk7XG4gIGNvbnN0IGRpZmZEYXlzID0gZGlmZlRpbWUgLyAoMTAwMCAqIDYwICogNjAgKiAyNCk7XG4gIFxuICByZXR1cm4gZGlmZkRheXMgPiAxO1xufVxuXG4vKipcbiAqIFVwZGF0ZSB1c2VyIHN0cmVhayB3aGVuIHRoZXkgcG9zdFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlVXNlclN0cmVhayh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8e1xuICBzdHJlYWtEYXlzOiBudW1iZXI7XG4gIGxvbmdlc3RTdHJlYWs6IG51bWJlcjtcbiAgc3RyZWFrSW5jcmVhc2VkOiBib29sZWFuO1xuICBzdHJlYWtSZXNldDogYm9vbGVhbjtcbn0+IHtcbiAgY29uc3QgdXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoe1xuICAgIHdoZXJlOiB7IGlkOiB1c2VySWQgfSxcbiAgICBzZWxlY3Q6IHtcbiAgICAgIHN0cmVha0RheXM6IHRydWUsXG4gICAgICBsYXN0U3RyZWFrRGF0ZTogdHJ1ZSxcbiAgICAgIGxvbmdlc3RTdHJlYWs6IHRydWUsXG4gICAgfSxcbiAgfSk7XG5cbiAgaWYgKCF1c2VyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdVc2VyIG5vdCBmb3VuZCcpO1xuICB9XG5cbiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgbGV0IG5ld1N0cmVha0RheXMgPSB1c2VyLnN0cmVha0RheXM7XG4gIGxldCBuZXdMb25nZXN0U3RyZWFrID0gdXNlci5sb25nZXN0U3RyZWFrO1xuICBsZXQgc3RyZWFrSW5jcmVhc2VkID0gZmFsc2U7XG4gIGxldCBzdHJlYWtSZXNldCA9IGZhbHNlO1xuXG4gIGlmICghdXNlci5sYXN0U3RyZWFrRGF0ZSkge1xuICAgIC8vIEZpcnN0IHRpbWUgcG9zdGluZyAtIHN0YXJ0IHN0cmVhayBhdCAxXG4gICAgbmV3U3RyZWFrRGF5cyA9IDE7XG4gICAgc3RyZWFrSW5jcmVhc2VkID0gdHJ1ZTtcbiAgfSBlbHNlIGlmIChpc1NhbWVEYXkodXNlci5sYXN0U3RyZWFrRGF0ZSwgbm93KSkge1xuICAgIC8vIEFscmVhZHkgcG9zdGVkIHRvZGF5IC0gbm8gY2hhbmdlIHRvIHN0cmVha1xuICAgIG5ld1N0cmVha0RheXMgPSB1c2VyLnN0cmVha0RheXM7XG4gIH0gZWxzZSBpZiAoaXNDb25zZWN1dGl2ZURheSh1c2VyLmxhc3RTdHJlYWtEYXRlLCBub3cpKSB7XG4gICAgLy8gUG9zdGVkIG9uIGNvbnNlY3V0aXZlIGRheSAtIGluY3JlbWVudCBzdHJlYWtcbiAgICBuZXdTdHJlYWtEYXlzID0gdXNlci5zdHJlYWtEYXlzICsgMTtcbiAgICBzdHJlYWtJbmNyZWFzZWQgPSB0cnVlO1xuICB9IGVsc2UgaWYgKGlzU3RyZWFrQnJva2VuKHVzZXIubGFzdFN0cmVha0RhdGUsIG5vdykpIHtcbiAgICAvLyBTdHJlYWsgYnJva2VuIC0gcmVzZXQgdG8gMVxuICAgIG5ld1N0cmVha0RheXMgPSAxO1xuICAgIHN0cmVha1Jlc2V0ID0gdHJ1ZTtcbiAgfVxuXG4gIC8vIFVwZGF0ZSBsb25nZXN0IHN0cmVhayBpZiBjdXJyZW50IGlzIGhpZ2hlclxuICBpZiAobmV3U3RyZWFrRGF5cyA+IG5ld0xvbmdlc3RTdHJlYWspIHtcbiAgICBuZXdMb25nZXN0U3RyZWFrID0gbmV3U3RyZWFrRGF5cztcbiAgfVxuXG4gIC8vIFVwZGF0ZSB1c2VyIGluIGRhdGFiYXNlXG4gIGF3YWl0IHByaXNtYS51c2VyLnVwZGF0ZSh7XG4gICAgd2hlcmU6IHsgaWQ6IHVzZXJJZCB9LFxuICAgIGRhdGE6IHtcbiAgICAgIHN0cmVha0RheXM6IG5ld1N0cmVha0RheXMsXG4gICAgICBsYXN0U3RyZWFrRGF0ZTogbm93LFxuICAgICAgbG9uZ2VzdFN0cmVhazogbmV3TG9uZ2VzdFN0cmVhayxcbiAgICAgIGxhc3RBY3RpdmVBdDogbm93LFxuICAgIH0sXG4gIH0pO1xuXG4gIHJldHVybiB7XG4gICAgc3RyZWFrRGF5czogbmV3U3RyZWFrRGF5cyxcbiAgICBsb25nZXN0U3RyZWFrOiBuZXdMb25nZXN0U3RyZWFrLFxuICAgIHN0cmVha0luY3JlYXNlZCxcbiAgICBzdHJlYWtSZXNldCxcbiAgfTtcbn1cblxuLyoqXG4gKiBHZXQgdXNlcidzIGN1cnJlbnQgc3RyZWFrIHN0YXR1c1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlclN0cmVhayh1c2VySWQ6IHN0cmluZyk6IFByb21pc2U8e1xuICBjdXJyZW50U3RyZWFrOiBudW1iZXI7XG4gIGxvbmdlc3RTdHJlYWs6IG51bWJlcjtcbiAgbGFzdFBvc3REYXRlOiBEYXRlIHwgbnVsbDtcbiAgaXNBY3RpdmU6IGJvb2xlYW47XG59PiB7XG4gIGNvbnN0IHVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHtcbiAgICB3aGVyZTogeyBpZDogdXNlcklkIH0sXG4gICAgc2VsZWN0OiB7XG4gICAgICBzdHJlYWtEYXlzOiB0cnVlLFxuICAgICAgbGFzdFN0cmVha0RhdGU6IHRydWUsXG4gICAgICBsb25nZXN0U3RyZWFrOiB0cnVlLFxuICAgIH0sXG4gIH0pO1xuXG4gIGlmICghdXNlcikge1xuICAgIHRocm93IG5ldyBFcnJvcignVXNlciBub3QgZm91bmQnKTtcbiAgfVxuXG4gIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7XG4gIGxldCBpc0FjdGl2ZSA9IGZhbHNlO1xuICBsZXQgY3VycmVudFN0cmVhayA9IHVzZXIuc3RyZWFrRGF5cztcblxuICAvLyBDaGVjayBpZiBzdHJlYWsgaXMgc3RpbGwgYWN0aXZlXG4gIGlmICh1c2VyLmxhc3RTdHJlYWtEYXRlKSB7XG4gICAgaWYgKGlzU2FtZURheSh1c2VyLmxhc3RTdHJlYWtEYXRlLCBub3cpKSB7XG4gICAgICAvLyBQb3N0ZWQgdG9kYXkgLSBzdHJlYWsgaXMgYWN0aXZlXG4gICAgICBpc0FjdGl2ZSA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChpc0NvbnNlY3V0aXZlRGF5KHVzZXIubGFzdFN0cmVha0RhdGUsIG5vdykpIHtcbiAgICAgIC8vIExhc3QgcG9zdCB3YXMgeWVzdGVyZGF5IC0gc3RyZWFrIGlzIGF0IHJpc2sgYnV0IHN0aWxsIGFjdGl2ZVxuICAgICAgaXNBY3RpdmUgPSB0cnVlO1xuICAgIH0gZWxzZSBpZiAoaXNTdHJlYWtCcm9rZW4odXNlci5sYXN0U3RyZWFrRGF0ZSwgbm93KSkge1xuICAgICAgLy8gU3RyZWFrIGlzIGJyb2tlbiAtIHNob3VsZCBiZSByZXNldCBvbiBuZXh0IHBvc3RcbiAgICAgIGN1cnJlbnRTdHJlYWsgPSAwO1xuICAgICAgaXNBY3RpdmUgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGN1cnJlbnRTdHJlYWssXG4gICAgbG9uZ2VzdFN0cmVhazogdXNlci5sb25nZXN0U3RyZWFrLFxuICAgIGxhc3RQb3N0RGF0ZTogdXNlci5sYXN0U3RyZWFrRGF0ZSxcbiAgICBpc0FjdGl2ZSxcbiAgfTtcbn1cblxuLyoqXG4gKiBDaGVjayBhbmQgcmVzZXQgc3RyZWFrcyBmb3IgdXNlcnMgd2hvIGhhdmVuJ3QgcG9zdGVkIGluID4yNGhcbiAqIFRoaXMgc2hvdWxkIGJlIHJ1biBhcyBhIHNjaGVkdWxlZCBqb2JcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNoZWNrQW5kUmVzZXRJbmFjdGl2ZVN0cmVha3MoKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgY29uc3QgeWVzdGVyZGF5ID0gbmV3IERhdGUobm93KTtcbiAgeWVzdGVyZGF5LnNldERhdGUoeWVzdGVyZGF5LmdldERhdGUoKSAtIDEpO1xuICB5ZXN0ZXJkYXkuc2V0SG91cnMoMCwgMCwgMCwgMCk7XG5cbiAgLy8gRmluZCB1c2VycyB3aG9zZSBsYXN0IHBvc3Qgd2FzIG1vcmUgdGhhbiAxIGRheSBhZ28gYW5kIGhhdmUgYW4gYWN0aXZlIHN0cmVha1xuICBjb25zdCBpbmFjdGl2ZVVzZXJzID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZE1hbnkoe1xuICAgIHdoZXJlOiB7XG4gICAgICBzdHJlYWtEYXlzOiB7IGd0OiAwIH0sXG4gICAgICBsYXN0U3RyZWFrRGF0ZTogeyBsdDogeWVzdGVyZGF5IH0sXG4gICAgfSxcbiAgICBzZWxlY3Q6IHsgaWQ6IHRydWUgfSxcbiAgfSk7XG5cbiAgLy8gUmVzZXQgdGhlaXIgc3RyZWFrc1xuICBpZiAoaW5hY3RpdmVVc2Vycy5sZW5ndGggPiAwKSB7XG4gICAgYXdhaXQgcHJpc21hLnVzZXIudXBkYXRlTWFueSh7XG4gICAgICB3aGVyZToge1xuICAgICAgICBpZDogeyBpbjogaW5hY3RpdmVVc2Vycy5tYXAodSA9PiB1LmlkKSB9LFxuICAgICAgfSxcbiAgICAgIGRhdGE6IHtcbiAgICAgICAgc3RyZWFrRGF5czogMCxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cblxuICByZXR1cm4gaW5hY3RpdmVVc2Vycy5sZW5ndGg7XG59XG4iXSwibmFtZXMiOlsicHJpc21hIiwiaXNDb25zZWN1dGl2ZURheSIsImxhc3REYXRlIiwiY3VycmVudERhdGUiLCJsYXN0RGF5IiwiRGF0ZSIsInNldEhvdXJzIiwiY3VycmVudERheSIsImRpZmZUaW1lIiwiZ2V0VGltZSIsImRpZmZEYXlzIiwiaXNTYW1lRGF5IiwiZGF0ZTEiLCJkYXRlMiIsImRheTEiLCJkYXkyIiwiaXNTdHJlYWtCcm9rZW4iLCJ1cGRhdGVVc2VyU3RyZWFrIiwidXNlcklkIiwidXNlciIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImlkIiwic2VsZWN0Iiwic3RyZWFrRGF5cyIsImxhc3RTdHJlYWtEYXRlIiwibG9uZ2VzdFN0cmVhayIsIkVycm9yIiwibm93IiwibmV3U3RyZWFrRGF5cyIsIm5ld0xvbmdlc3RTdHJlYWsiLCJzdHJlYWtJbmNyZWFzZWQiLCJzdHJlYWtSZXNldCIsInVwZGF0ZSIsImRhdGEiLCJsYXN0QWN0aXZlQXQiLCJnZXRVc2VyU3RyZWFrIiwiaXNBY3RpdmUiLCJjdXJyZW50U3RyZWFrIiwibGFzdFBvc3REYXRlIiwiY2hlY2tBbmRSZXNldEluYWN0aXZlU3RyZWFrcyIsInllc3RlcmRheSIsInNldERhdGUiLCJnZXREYXRlIiwiaW5hY3RpdmVVc2VycyIsImZpbmRNYW55IiwiZ3QiLCJsdCIsImxlbmd0aCIsInVwZGF0ZU1hbnkiLCJpbiIsIm1hcCIsInUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/streak-manager.ts\n");

/***/ })

};
;